<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Olive Energy Meter</title>
  <link rel="icon" type="image/png" href="logo.png">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <style>
    * {
      padding: 0;
      margin: 0;
    }

    body {
      background: rgb(201, 195, 195);
    }

  
        #expandableDiv {
         
            transition: all 0.5s ease;
        }
       
        .expanded {
          position: fixed;
            top: 100px;
            left: 0;
            width: 90%;
            height: 100%;
            z-index: 1000;
        }
    .breadcrumb-item a {
      color: inherit;
      text-decoration: inherit;
    }

    .footer {
      position: relative;
      bottom: 0;
      left: 0;
      /* Make sure the footer spans the full width */
      width: 100%;
      /* Ensure the footer spans the full width */
      display: flex;
      justify-content: center;
      align-items: center;
      /* Center vertically */
      background-color: #333;
      /* Just for visualization */
      color: white;
      /* Just for visualization */
    }
    #logoutCard1 {
      position: absolute;
      top: 60px; /* Adjust this value as needed */
      right: 0;
      background-color: #d1cbcb;
      border: 1px solid #ccc;
      padding: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
      z-index: 1000; /* Ensure the card appears above other elements */
    }
    .navbar-nav {
    display: flex;
    justify-content: space-between;
    width: 100%;
font-size: 20px;
  }
  .nav-item {
    padding: 0px 30px;
    transition:all  .4s ease-in-out;
  }
  .nav-item:hover{
   transform: scale(1.5);
  }
  </style>
  <link rel="stylesheet" href="universal.css">
</head>

<body>
  <div class="con"></div>
  <div class="container-fluid main">
    <div class="container-fluid nav-section mb-5">
      <nav class="navbar navbar-expand-sm  fixed-top bg-info">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">
            <img src="logo.png" alt="Avatar Logo" style="width:40px;" class="rounded-pill">
          </a>
          <h5 class="nav-title text-dark mt-2">Olive Energy Meter</h5>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mynavbar">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="mynavbar">
            <ul class="navbar-nav me-auto" style="display: flex; justify-content: center; width: 100%;">
              <li class="nav-item">
                <a class="nav-link" href="home.html">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="addProjects.html">Project</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="addUser.html">User</a>
              </li>
            </ul>
            <div>
          </div>
          

              <form id="searchForm" class="d-flex">
                  <input id="searchInput"  list="page"  class="form-control me-2" type="text" placeholder="Search">
                  <datalist id="page">
                    <option value="home">
                    <option value="project">
                    <option value="user">
                 
                  </datalist>
                  <button id="searchButton" class="btn btn-primary me-5" type="submit">Search</button>
              </form>
              <div id="searchResults"></div>
          </div>
            <div id="logoutIcon" style="cursor: pointer;">
              <i class="fa fa-sign-out text-muted" aria-hidden="true" style="font-size: 25px;"></i>
            </div>
          
            <!-- Logout confirmation card -->
            <div id="logoutCard1" style="display: none;">
              <i class="ms-5 fa fa-user text-primary " aria-hidden="true" style="font-size: 50px;"></i>
              <p class="text-dark">Are you sure<br> you  want to logout?</p>
              <button id="logOut" class="btn btn-danger text-white">Logout</button>
            </div>
          </div>
        </div>
      </nav>


    </div>
    <button onclick="scrollToTop()" id="scrollToTop"  class="btn btn-secondary" title="Go to top"><i class="fa fa-arrow-up" aria-hidden="true"></i></button>
    <div class="container-fluid main-section mt-5">
      
      <div class="row mt-3 ">
        <div class="col-lg-12 col-md-12 aside-section main-item">
          <div class="row pt-5 ps-3 ">
            <ul class="breadcrumb">
                <li class="breadcrumb-item"><a href="home.html"><i class="fa fa-home "></i> Home </a></i></li>



            </ul>
        </div>
        <div class="row  w3-animate-zoom">
            <div class="col-lg-12 col-md-12 main-chart">
                <div class="row">
                    <div class="col-lg-8 col-md-12  w3-center">

                        <div class="row">

                            <div class="col-lg-6 col-sm-12  p-1">
                              <div class="row px-2 ms-2 "> <div class="bg-white p-3    border border-light border-3">
                                <div class="card   expandable-card w3-animate-zoom" id="expandCard">
                                    <div class="card-header text-primary h4">Overall Products Summary</div>
                                    <div class="card-body py-4" >

                                      <div class="row">
                                        <div class="col-lg-6">
                                          <div class="card-title">Overall Units </div>
                                        </div>
                                        <div class="col-lg-6">
                                          <div class="card-text h5 text-success">
                                            11

                                        </div>
                                        </div>
                                      </div>
                                       
                                       
                                        
                                      <div class="row">
                                        <div class="col-lg-6">
                                          <div class="card-title">Live Units </div>
                                        </div>
                                        <div class="col-lg-6">
                                          <div class="card-text h5 text-success">
                                            10

                                        </div>
                                        </div>
                                      </div>
                                       
                                    </div>
                                </div>
                            </div>
                      </div>
                      <div class="row mt-3 ms-2 px-2">
                        <div class="bg-white p-3    border border-light border-3">

                          <div class="card   expandable-card w3-animate-zoom" id="expandCard">
                              <div class="card-header text-primary h4">Overall Production</div>
                              <div class="card-body py-4" >

<div class="row"><div class="col-lg-6"><div class="card-title">Units Consumed</div></div>
<div class="col-lg-6"> <div class="card-text h5 text-success">
  120 <span class="text-dark">INR</span>

</div></div></div>
                                  <div class="row">
                                    <div class="col-lg-6"><div class="card-title ">Production Rate </div></div>
                                 <div class="col-lg-6"> <div class="card-text h5 text-success">
                                  70 <span class="text-dark">%</span>

                              </div></div>
                                  </div>
                                 
                                  
                                 



                              </div>
                          </div>
                      </div>
                      </div>
                      </div>
                                 
                            <div class="col-lg-6 col-sm-12  px-3">
                              <div class="bg-white p-3    border border-light border-3">

                                <div class="card w3-animate-zoom w-100">
<div class="card-header">Power Consumption</div>
                                    <div class="card-body " style="height: 320px;">


                                        <div id="piechart_3d"
                                            style="margin-left: -15px;margin-top:10px;margin-bottom:30px;"></div>
                                    </div>
                                </div>
                            </div>
                            </div>

                        </div>
                    </div>
                    <div class="col-lg-4 col-md-12 ">

                        <div class="row ">

                            <div class="col-lg-12 col-sm-12  px-1 w3-animate-zoom">
                                <div class="bg-white p-3    border border-light border-3">
                                    <div class="card   " >

                                        <div class="card-body " style="height: 355px;">


                                            <div id="chart"></div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                     
                        </div>
                    </div>
                  </div>
              

                
            </div>
         


        </div>

        
          <div class="row table-menu mb-5 px-5">
            <div class="container mt-5 col-12 border-top border-primary pt-4 " style="background-color: rgb(216, 209, 209);" id="tableContent">
             <div class="row">
              <div class="col-lg-4"><div class="h4 text-secondary">Project details</div></div>
              <div class=" col-lg-8 container-fluid d-flex justify-content-end">
               
                <div class="form d-flex  ">
                  <!-- <button class="btn btn-danger  me-2 w-50" id="refresh"><i class="fa fa-refresh me-2" ></i>Refresh</button> -->
                    <input type="text" name="search" id="search" class="form-control me-1" size="50"
                        placeholder="Search Here" onkeyup="myFunction()">
                   
                </div></div></div>
              
         

              <table class="table table-primary table-bordered mt-3 w3-center w3-animate-zoom table-hover table-responsive" id="usersTable">
                <thead>
                  <tr>
                    <th class="py-3">No</th>
                    <th class="py-3">Project Name </th>
                    <th class="py-3">Email</th>
                    
                    <th class="py-3">Action</th>
                  </tr>
                </thead>
                <tbody class="table-light" id="usersTableBody">
                </tbody>
              </table>
            </div>


          </div>
        </div>
      
      </div>
    </div>

  </div>
  <div class="container-fluid">
    <div class="row d-flex justify-content-center">
     
    </div>
  </div>
  <!-- Offcanvas Bottom  -->
  <div class="offcanvas offcanvas-top" id="demo">
    <div class="offcanvas-header">
      <h1 class="offcanvas-title">Heading</h1>
      <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body">
      <p>Some text lorem ipsum.</p>
      <p>Some text lorem ipsum.</p>
      <button class="btn btn-secondary" type="button">A Button</button>
    </div>
  </div>
  <footer class="footer">
    <h5 class="footer-content">&copy;All Rights Reserved Olive IOT</h5>
  </footer>
</body>
<script src="search.js"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>


<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>







<script type="text/javascript">
  // Function to get the last two days' names
  function getLastTwoDays() {
    const daysOfWeek = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
    const today = new Date();
    const yesterday = new Date(today);
    yesterday.setDate(today.getDate() - 1);

    return [
      daysOfWeek[yesterday.getDay()],
      daysOfWeek[today.getDay()]
    ];
  }

  const lastTwoDays = getLastTwoDays();

  var options = {
    series: [{
      name: 'Cost $',
      data: [100, 200]
    }],
    annotations: {
      points: [{
        x: 'Production',
        seriesIndex: 0,
        label: {
          borderColor: '#775DD0',
          offsetY: 0,
          style: {
            color: '#fff',
            background: '#775DD0',
          },
          text: '',
        }
      }]
    },
    title: {
      text: 'Overall Production',
      align: 'left'
    },
    chart: {
      height: 350,
      type: 'bar',
    },
    plotOptions: {
      bar: {
        borderRadius: 10,
        columnWidth: '50%',
      }
    },
    dataLabels: {
      enabled: false
    },
    stroke: {
      width: 0
    },
    grid: {
      row: {
        colors: ['#fff', '#f2f2f2']
      }
    },
    xaxis: {
      labels: {
        rotate: -45
      },
      categories: lastTwoDays,
      tickPlacement: 'on'
    },
    yaxis: {
      title: {
        text: 'COST',
      },
    },
    fill: {
      type: 'gradient',
      gradient: {
        shade: 'light',
        type: "horizontal",
        shadeIntensity: 0.25,
        gradientToColors: undefined,
        inverseColors: true,
        opacityFrom: 0.85,
        opacityTo: 0.85,
        stops: [50, 0, 100]
      },
    }
  };

  var chart = new ApexCharts(document.querySelector("#chart"), options);
  chart.render();
</script>


<script type="text/javascript">
  var options = {
      series: [44, 55, 13, 33, 22], // Make sure the number of values matches the number of labels
      chart: {
          width: 380,
          type: 'donut',
      },
      title: {
      text: '',
      align: 'left'
    },
      labels: ['Machine 1', 'Machine 2', 'Machine 3', 'Machine 4', 'Machine 5'], // Add this line for labels
      dataLabels: {
          enabled: false
      },
      responsive: [{
          breakpoint: 480,
          options: {
              chart: {
                  width: 200
              },
              legend: {
                  show: false
              }
          }
      }],
      legend: {
          show: true,
          position: 'bottom'
      }
  };

  var chart = new ApexCharts(document.querySelector("#piechart_3d"), options);
  chart.render();
</script>






<script type="module">




  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-analytics.js";
  //  import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-auth.js";
  // import { getDatabase,ref,onValue} from "https://www.gstatic.com/firebasejs/10.11.0/firebase-database.js"; 
  // import { getDatabase, ref, onValue } from "./firebase/database";
  import { getDatabase, ref, onChildAdded, orderByChild, onValue, remove } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-database.js";


  const firebaseConfig = {

    apiKey: "AIzaSyCaAt7YTQBOfXph8A7NtLwqayqsqQfPITY",
    authDomain: "three-phase-energy-meter.firebaseapp.com",
    projectId: "three-phase-energy-meter",
    storageBucket: "three-phase-energy-meter.appspot.com",
    messagingSenderId: "643707481883",
    appId: "1:643707481883:web:b442d0e444b6a849e06dbe",
    measurementId: "G-ZC6S4GQJD3"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
  const db = getDatabase(app);
  // const userId="OliveEnergy";


  // function addProject(projectName) {
  //     const projectsRef = ref(database, 'projects'); // Assuming 'projects' is the path in your database
  //     push(projectsRef, {
  //         name: projectName
  //     });
  // }





  function addTableRow(sequenceNumber, userId) {

    const userRef = ref(db, 'users/' + userId);
    // const userRef =ref(db,`users/${userId}`); // Assuming 'users' is the path in your database
    try {
      onValue(userRef, (snapshot) => {
        const user = snapshot.val();
        if (user) {
          const usersTableBody = document.getElementById('usersTableBody');
          const row = document.createElement('tr');
          const Project_Name = user.Project_Name;
          row.innerHTML = `
              <td>${sequenceNumber}</td>
              <td>${user.Project_Name}</td>
              <td>${user.Contact_email}</td>
              
              <td>
                  <button class="btn btn-success px-4 py-1 ms-1 me-1" data-edit-name="${Project_Name}">Edit</button>
  <button class="btn btn-primary px-2 py-1 ms-1 me-1" data-project-name="${Project_Name}">View</button>
 
</td>  
          `;
          console.log(user.Project_Name)
          usersTableBody.appendChild(row);
        }
      });
    }
    catch (e) {
      console.log("Error to getting Database" + e);
    }
  }
  let sequenceNumber = 1;
  const userRef1 = ref(db, 'users');
  // Call addTableRow for each user
  onChildAdded(userRef1, (data) => {
    const userId = data.key;
    addTableRow(sequenceNumber++, userId);
  });

  function refreshPage() {
    location.reload(); // Reload the page
  }

  document.addEventListener('click', (event) => {
    if (event.target.classList.contains('btn-primary')) {
      const projectName = event.target.getAttribute('data-project-name');
      if (projectName) {
        viewProject(projectName);
      } else {
        console.error('Project name not found.');
      }
    }
  });
  document.addEventListener('click', (event) => {
    if (event.target.classList.contains('btn-success')) {
      const projectName = event.target.getAttribute('data-edit-name');
      if (projectName) {
        editProject(projectName);
      } else {
        console.error('Project name not found.');
      }
    }
  });

  function editProject(projectName) {
    window.location.href = `addCustomer.html?projectName=${encodeURIComponent(projectName)}`;

  }
  function viewProject(projectName) {
    window.location.href = `dashboard.html?projectName=${encodeURIComponent(projectName)}`;

  }

 


    // Refresh table

  

    // Add click event listener to the Refresh button
    document.getElementById('refresh').addEventListener('click', () => {
        window.location.reload();
    });


</script>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-analytics.js";
  import { getAuth, signInWithEmailAndPassword,signOut} from "https://www.gstatic.com/firebasejs/10.11.0/firebase-auth.js";

  const firebaseConfig1 = {
      apiKey: "AIzaSyCaAt7YTQBOfXph8A7NtLwqayqsqQfPITY",
      authDomain: "three-phase-energy-meter.firebaseapp.com",
      projectId: "three-phase-energy-meter",
      storageBucket: "three-phase-energy-meter.appspot.com",
      messagingSenderId: "643707481883",
      appId: "1:643707481883:web:b442d0e444b6a849e06dbe",
      measurementId: "G-ZC6S4GQJD3"
  };

  // Initialize Firebase
  const app1 = initializeApp(firebaseConfig1);
  const analytics1 = getAnalytics(app1);
  console.log(app1);
  const auth = getAuth();

  // Get logout icon and card elements
const logoutIcon1 = document.getElementById('logoutIcon');
const logoutCard3 = document.getElementById('logoutCard1');


// Show the logout card when the logout icon is clicked
logoutIcon1.addEventListener('click', () => {
  if (logoutCard3.style.display === 'block') {
    logoutCard3.style.display = 'none';
  } else {
    logoutCard3.style.display = 'block';
  }
});



// Hide the logout card when the user clicks outside of it


// Logout when the logout button is clicked
document.getElementById('logOut').addEventListener('click', () => {
  const confirmLogout = confirm('Are you sure you want to logout?');
  if (confirmLogout) {
    signOutUser(); // Call the signOut function from auth.js
  }
});
function signOutUser() {
  signOut(auth).then(() => {
    // Sign-out successful.
    window.location.href = "index.html";
  }).catch((error) => {
    // An error happened.
    console.error(error.message);
  });
}

</script>
<script>
  function myFunction(){
    const input = document.getElementById('search');
      const filter = input.value.toUpperCase();
      const table = document.getElementById('usersTable');
      const rows = table.getElementsByTagName('tr');

      for (let i = 1; i < rows.length; i++) { // Start from index 1 to skip the header row
        const cells = rows[i].getElementsByTagName('td');
        let found = false;
        for (let j = 0; j < cells.length; j++) {
          const cellText = cells[j].innerText.toUpperCase();
          if (cellText.includes(filter)) {
            found = true;
            break;
          }
        }
        rows[i].style.display = found ? '' : 'none';
      }
  }
</script>
<script src="expand.js"></script>
<script >
  document.addEventListener('DOMContentLoaded', function () {
    var expandableDivs = document.querySelectorAll('.expandableDiv');
    var fullViewButtons = document.querySelectorAll('.fullViewButton');

    fullViewButtons.forEach(function (button, index) {
        button.addEventListener('click', function () {
            expandDiv(expandableDivs[index]);
        });
    });

    function expandDiv(div) {
        if (!div.classList.contains('expanded')) {
            div.classList.add('expanded');
        } else {
            div.classList.remove('expanded');
        }
    }
});

</script>
<script src="scrollTop.js"></script>
</html>
